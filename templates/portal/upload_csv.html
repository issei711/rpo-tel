{% extends "admin/base_site.html" %}
{% load static %}

{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'portal/css/upload_csv.css' %}">
{% endblock %}

{% block content_title %}
  <h1 class="upload-title">{{ company.name }} ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼æƒ…å ±ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h1>
{% endblock %}

{% block content %}
  <div class="upload-container">

    <p class="nav-links">
      <a href="{% url 'company_portal_index' %}">ğŸ“‚ ä¼æ¥­ãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹</a>
      |
      <a href="{% url 'admin:students_student_changelist' %}?company={{ company.id }}">ğŸ‘¥ ã‚¨ãƒ³ãƒˆãƒªãƒ¼ä¸€è¦§ã‚’è¦‹ã‚‹</a>
    </p>

    <p class="download-template">
      <a href="{% url 'student_csv_template' company_id=company.id %}" class="btn-template">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆCSVã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a>
    </p>

    <p class="download-guide">
      <a href="{% url 'exchange_csv' %}">
        å„åª’ä½“ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›
      </a>
    </p>

    {% if messages %}
      <ul class="messagelist">
        {% for message in messages %}
          <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
            {{ message }}
          </li>
        {% endfor %}
      </ul>
    {% endif %}

    <div class="form-wrapper">
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <h2>CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
        <p class="hint">
          â€» <code>company</code> åˆ—ã®å€¤ãŒ <strong>{{ company.name }}</strong> ã¨ä¸€è‡´ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
        </p>

        <div class="file-select">
          <label for="csv_file" class="btn-blue">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</label>
          <input type="file" id="csv_file" name="csv_file" accept=".csv" required>
          <span id="file-name">ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“</span>
        </div>

        <div class="submit-btn">
          <button type="submit" class="btn-green">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
        </div>
      </form>

      <hr>

      <h3>CSVã®ã‚«ãƒ©ãƒ ä»•æ§˜</h3>
      <table class="spec-table">
        <thead>
          <tr>
            <th>CSVã‚«ãƒ©ãƒ å</th>
            <th>æ„å‘³ï¼ˆæ—¥æœ¬èªï¼‰</th>
          </tr>
        </thead>
        <tbody>
          {% for key, label in csv_headers %}
            <tr>
              <td><code>{{ key }}</code></td>
              <td>
                {{ label }}
                {% if key in required_fields %}
                  <span class="required">ğŸ”´ å¿…é ˆ</span>
                {% endif %}
                {% if label == 'å¤§åˆ†é¡' %}
                  (<a href="/admin/students/pattern/">ãƒ‘ã‚¿ãƒ¼ãƒ³</a>ã¨ä¸€è‡´å¿…é ˆ)
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script src="{% static 'portal/js/upload_csv.js' %}"></script>
{% endblock %}
